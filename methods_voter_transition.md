# Methods: Simplified Hierarchical Voter Transition Model

## Data and Problem Overview

We analyze voter transitions between consecutive elections using aggregate polling-station data. In this setting, we observe for each polling station the counts of voters who chose each political category in the initial election (time *t*) and the counts for each category in the subsequent election (time *t+1*). Our goal is to infer the **individual-level transition probabilities** – i.e. the probability that a voter moves from category *i* at time *t* to category *j* at time *t+1*. This problem is inherently difficult because individual ballots are secret and only aggregate counts are available, a classic **ecological inference** scenario (Robinson, 1950; King, 1997). As a result, naïve methods can fall prey to the **ecological fallacy** – drawing false conclusions about individuals from aggregate data (Robinson, 1950). Prior research in political methodology has developed various strategies for this problem, from Goodman’s linear ecological regression (Goodman, 1953) to more complex Bayesian models (King, 1997; Rosen et al., 2001). We build on this literature by proposing a hierarchical Bayesian model that addresses several key challenges in estimating voter transition matrices:

- **Unobserved individual transitions:** We only have marginal totals, not who voted for whom twice. Our model treats the unobserved transition counts as latent variables to be inferred, avoiding reliance on potentially biased survey recall data (Dassonneville and Hooghe, 2017).
- **Aggregation and heterogeneity:** Voting patterns can vary widely across regions. Traditional ecological inference often assumes a common transition matrix for all units (e.g., the **“uniform swing”** assumption; Brown and Payne, 1986), which can be unrealistic. We introduce a hierarchical structure allowing **city-specific deviations** from the national trend, acknowledging spatial heterogeneity in voter behavior (Johnston and Hay, 1983).
- **High dimensionality:** A full transition matrix for $K$ categories has $K \times K$ parameters, which can be data-intensive to estimate for each locality. We impose a **low-dimensional (rank-1) structure** on city-level deviations to regularize the problem, drawing inspiration from dimension-reduction techniques in electoral analysis (Brown and Payne, 1986; Forcina and Pellegrino, 2019).
- **Overdispersion in counts:** Voters are not identically distributed random draws; precincts often exhibit correlated behavior due to social networks and demographic clustering. We account for **overdispersion** beyond the multinomial assumption by using an overdispersed likelihood, improving uncertainty estimates (Wakefield, 2004; Forcina and Pellegrino, 2019).

Our application focuses on four political categories in Israeli elections – **Shas**, **Agudat Israel**, **Other parties**, and **Abstention** – which represent distinct voting blocs (religious Sephardic, religious Ashkenazi, all other votes, and non-voters, respectively). These categories allow us to track both vote switching between parties and movements into or out of the active electorate. We align polling stations between election $t$ and $t+1$ and construct aggregated counts $x^{(1)}_{s}$ and $x^{(2)}_{s}$ for each station $s$ (at elections $t$ and $t+1$). By modeling the unseen flows between these categories, we aim to recover a **transition matrix** that is consistent with the observed margins in all stations.

## Hierarchical Transition Model

### Transition Matrix Framework

At the core of the model is a **voter transition matrix** $M$, where each entry $M_{ij}$ represents the probability that a voter in category *j* at time *t* votes for category *i* at time *t+1*. Each column of $M$ thus sums to 1 (each voter from a given origin chooses one destination). The matrix is $K \times K$ (here $4\times4$ for our categories). We interpret the diagonal entries $M_{ii}$ as **voter loyalty** (the probability of staying with the same party) and the off-diagonals as **switching probabilities** (e.g., $M_{\text{Agudat},\,\text{Shas}}$ is the chance a Shas voter switches to Agudat Israel). High values on the diagonal indicate strong partisan continuity, consistent with prior findings that many voters remain “party faithful” across elections (Campbell, Green, and Layman, 2011). Off-diagonal elements capture phenomena like party switching, protest voting, or new voter mobilization/abstention.

Because we lack individual-level data, $M$ cannot be directly observed. Instead, we observe aggregate counts at each station. Let $n^{(2)}_{s}$ be the total number of votes cast in station $s$ at time $t+1$, and let $q_{s}$ be the (unobserved) vector of *proportions* of each category in that station at $t+1$. Under the assumption that each station’s voters follow the same transition probabilities $M$ (adjusted for local effects), the expected proportions at $t+1$ relate to the observed proportions at $t$ via:

$$ q_{s} = p^{(1)}_{s} \times M^T, $$

where $p^{(1)}_{s}$ is the vector of observed proportions in station $s$ at time $t$ (obtained from $x^{(1)}_{s}$ by dividing by its sum). Intuitively, if 10% of station $s$ voted for Shas at time $t$ and the Shas-to-Agudat switching probability is $M_{\text{Agudat, Shas}}=0.10$, then $p^{(1)}_{s}$ contributes a 1% expected proportion to Agudat in that station at $t+1$ via former Shas voters. Summing over all origin categories yields $q_{s}$. These $q_{s}$ are then linked to the observed counts $x^{(2)}_{s}$ through a probabilistic model.

### Hierarchical Structure and Rank-1 City Deviations

We introduce a three-level hierarchical structure to allow both national patterns and local deviations:

1. **Country-level transition matrix ($M^\text{country}$):** This matrix captures the baseline voting transition tendencies for the entire country. It can be interpreted as the “average” transition behavior absent any local idiosyncrasy. We assume all stations share this underlying matrix, which is informed by the aggregate national vote totals. This is similar to previous ecological inference models that first estimate a single transition matrix for all units (King, 1997; Rosen et al., 2001). However, unlike a fixed national matrix, we treat $M^\text{country}$ as a set of parameters to be estimated with uncertainty in a Bayesian framework (with priors described below).

2. **Shared deviation pattern ($D$):** We allow cities or regions to systematically deviate from the national matrix along a **common pattern** $D$. Here $D$ is a full $K\times K$ matrix (of the same dimension as $M$) that represents how transition probabilities tend to shift in deviating cities relative to the national baseline. Importantly, $D$ is **not** specific to any one city; it is a global pattern learned from the data, analogous to a single latent factor that explains the major axis of variation in transition behavior across cities. By having a common $D$, we assume that when local voting behavior diverges from national trends, it does so in broadly similar ways across different cities – for example, religious municipalities might universally exhibit higher loyalty to religious parties and lower turnout drop-off compared to the national average. This assumption reflects the idea that many local differences are driven by shared demographic or cultural factors (e.g., Haredi vs. secular communities) rather than completely unique city-by-city quirks, and it greatly reduces model complexity.

3. **City-specific scalar ($\delta_c$):** For each city $c$, we introduce a scalar parameter $\delta_c$ that scales the global deviation pattern $D$ up or down. The city’s transition matrix is thus constructed as:

$$ M^{(c)} = \text{softmax}\big(Z^\text{country} + \delta_c \, D\big), $$

where $Z^\text{country}$ is a matrix of underlying logits for the country-level transitions (see next section) and the softmax is applied separately to each column to ensure valid probabilities. A positive $\delta_c$ means city $c$ accentuates the transitions indicated by $D$ (for example, if $D_{\text{Shas}\to \text{Shas}}$ is positive, a city with $\delta_c > 0$ shows **higher** Shas loyalty than average; if $D_{\text{Shas}\to \text{Other}}$ is negative, that city shows **lower** defection from Shas to other parties than average). A negative $\delta_c$ would imply the city moves in the opposite direction of $D$. If $\delta_c = 0$, city $c$ effectively follows the national pattern exactly. The magnitude $|\delta_c|$ indicates how strongly city $c$ deviates: larger absolute values mean the local transition probabilities are further from the national baseline. By capturing each city’s effect with a single number, we achieve a drastic reduction in parameters compared to allowing a full $K\times K$ matrix per city. This is a **rank-1 approximation** to the full set of city deviations, in the sense that all deviations lie on a one-dimensional line in the space of possible matrices. This approach is parsimonious and interpretable – each city gets a single “deviation score” – and is supported by substantive insights that many electoral shifts are driven by one dominant cleavage (e.g., urban–rural, religious–secular, or regional divides) (Brown and Payne, 1986; Puig and Ginebra, 2015). The traditional uniform swing model (Brown and Payne, 1986), which assumes the same swing everywhere, is a special case of our model with $\delta_c=0$ for all cities (i.e. no local deviation). Our model generalizes this by letting $\delta_c$ vary, while still borrowing strength from a shared $D$. This hierarchy reflects the idea of **partial pooling**: if a city has very little data, its $\delta_c$ will shrink toward 0 (national pattern), whereas cities with strong evidence of a different pattern can have $\delta_c$ significantly non-zero (Gelman and Hill, 2007).

### Logistic-Normal Parameterization

To estimate transition probabilities without the constraints and biases of Dirichlet priors (which can impose unwarranted independence among probabilities), we adopt a **logistic-normal** modeling strategy (Wakefield, 2004; Glynn and Wakefield, 2010). Instead of assigning a prior directly on each $M_{ij}$, we work in an unconstrained **logit space** and then transform to probabilities. Specifically, we define a matrix of latent logits $Z^\text{country}_{ij}$ for the country-level transitions. Each column $j$ of $Z^\text{country}$ corresponds to voters who were in category $j$ at time $t$, and $Z^\text{country}_{ij}$ represents the log-odds (relative to an arbitrary baseline) that those voters choose category $i$ at time $t+1$. By modeling logits, we can naturally incorporate covariates or structural priors. In our case, we add a **diagonal bias** term to the logits of same-party transitions to reflect prior belief in voter inertia. Formally, for each origin category $j$ we set:

$$ Z^\text{country}_{ij} = \alpha_{ij} + B \cdot \mathbf{1}(i=j), $$

where $\alpha_{ij} \sim \mathcal{N}(0, \sigma^2_\text{country})$ is a zero-mean normal prior for the base logit, and $B$ is a **loyalty bias** parameter (added only if $i=j$) with its own prior. By adding $B$ to the diagonal elements in log-odds, we push the baseline transition matrix toward favoring loyal voters. We center $B$’s prior at a positive value (e.g. mean 3.0 on the logit scale) corresponding to a strong prior odds in favor of staying with one’s party. This encodes the well-documented tendency of voters to stick with their previous choice (Campbell, Green, and Layman, 2011; Clarke et al., 2004) while still allowing the data to speak (the parameter is learned from data, just with an informative prior). After obtaining the adjusted logits $Z^\text{country}_{:\,j}$ for column $j$, we apply a softmax transformation to produce the probability vector $M^\text{country}_{:\,j} = \mathrm{Softmax}(Z^\text{country}_{:\,j})$. This ensures each column of the transition matrix sums to 1 and maps the unconstrained real values into $(0,1)$ probabilities.

We similarly parameterize the **deviation pattern** $D$ with logits (since $D$ represents adjustments in logit space). Each element of $D$ is given a zero-mean prior $D_{ij} \sim \mathcal{N}(0, \sigma^2_D)$ with a small scale $\sigma_D = 0.3$ to prevent overfitting. The city-specific scalars $\delta_c$ are given **simplified normal priors** for computational stability: we use a normal distribution $\delta_c \sim \mathcal{N}(0, \sigma_\delta)$ with scale $\sigma_\delta = 0.5$. This simplified approach trades some robustness to outliers for improved convergence properties. In practice, this means most cities will have $\delta_c$ near 0 (no strong deviation), and the tighter priors prevent extreme parameter values that can cause sampling difficulties. While this approach may be less robust to truly exceptional cities compared to heavy-tailed priors, it provides much more reliable inference for the typical case where city deviations are moderate.

Finally, to complete the Bayesian specification, we place tighter priors on hyperparameters for improved stability: $\sigma_\text{country} = 0.5$ and $\sigma_D = 0.3$ (reduced from previous values), and the loyalty bias $B$ has a moderately informative prior $\mathcal{N}(2.0, 0.3^2)$ (reduced from previous $\mathcal{N}(3.0, 0.5^2)$). These tighter priors prevent extreme parameter values that can cause convergence issues while still allowing the data to inform the estimates. The simplified approach prioritizes reliable inference over maximum flexibility, which is appropriate when the primary goal is obtaining trustworthy transition matrix estimates rather than modeling every possible source of variability.

### Likelihood and Simplified Overdispersion

A critical component of our method is modeling how the latent transition probabilities produce the observed vote counts. We use a **Dirichlet-multinomial** likelihood to account for overdispersion beyond the basic multinomial assumption. However, in the simplified model, we **fix the concentration parameter** $\phi = 100.0$ rather than estimating it. This reduces model complexity while still providing some overdispersion relative to a pure multinomial (which would correspond to $\phi \to \infty$). The fixed value was chosen to provide moderate overdispersion based on typical electoral data patterns, balancing computational stability with realistic variance modeling. This simplification trades the ability to learn the optimal overdispersion level from data for improved convergence properties. Formally, for each station $s$ in city $c$, our likelihood is:

$$
x^{(2)}_{s} \;\sim\; \text{Dirichlet-Multinomial}\Big(n^{(2)}_{s},\; \phi \cdot q^{(c)}_{s}\Big),
$$

where $q^{(c)}_{s} = p^{(1)}_{s} \times (M^{(c)})^T$ is the expected vote share vector for station $s$ given city $c$'s transition matrix. With $\phi = 100.0$ fixed, the model provides moderate overdispersion while maintaining computational tractability. This formulation falls under the class of **hierarchical multinomial-Dirichlet models** which have been recommended for ecological inference in multi-category voting data (Greiner and Quinn, 2010; Forcina and Pellegrino, 2019).

### Estimation and Sampling Strategy

We fit the simplified model using a **progressive sampling strategy** designed for improved convergence. The approach uses two stages:

1. **Stage 1 - Initial Adaptation**: Conservative burn-in with 2,000 tuning samples and 500 draws, using lower target acceptance (0.90) and "jitter+adapt_diag" initialization to explore the posterior broadly.

2. **Stage 2 - Main Sampling**: Full sampling with 3,000 tuning and 3,000 draws per chain, using higher target acceptance (0.95) and "adapt_diag" initialization for refined sampling.

We use 4 chains and check convergence diagnostics (Gelman–Rubin $\hat{R} < 1.01$, effective sample sizes > 400, and lack of divergent transitions) to ensure reliable inference. The simplified model with tighter priors and fixed overdispersion shows dramatically improved convergence compared to the previous complex version, with R-hat values typically around 1.02 and effective sample sizes well above minimum thresholds.

## Interpretation of Model Outputs

The hierarchical structure provides several parameters that yield substantive insights into voting behavior:

- **National transition matrix ($M^\text{country}$):** This gives the baseline pattern of voter flows. From it one can read, for example, the overall retention rate of each party (diagonal entries) and the main destinations of defectors from each party (row proportions off the diagonal). High diagonal values in $M^\text{country}$ would confirm that most voters remain with the same party (consistent with prior political behavior research), whereas significant off-diagonals would highlight notable nationwide shifts (e.g., if a substantial fraction of *Party A* voters switched to *Party B*). These aggregate transitions can be compared to simpler measures of electoral volatility (such as Pedersen’s index) and to survey-based transition estimates, providing a baseline for further analysis (King, 1997; Dassonneville and Hooghe, 2017).

- **City deviation scalars ($\delta_c$):** Each $\delta_c$ summarizes how city $c$’s transition probabilities diverge from the national pattern. A $\delta_c$ near zero means city $c$ mirrors the national trends closely. A large positive $\delta_c$ means that *in city $c$*, transitions in the direction indicated by $D$ are **more pronounced** than nationally, while a large negative $\delta_c$ means they are **reversed or weaker**. For instance, if $D$ emphasizes higher loyalty to a certain party and lower turnout (abstention) rates, a city with $\delta_c = +2$ would exhibit especially high loyalty and low dropout, whereas a city with $\delta_c = -2$ would show the opposite (low loyalty, higher dropout). By examining the posterior distribution of $\delta_c$ for each city, we can identify which cities significantly deviate (those with $\delta_c$ posteriors far from 0) and in which direction. This yields a **ranking of cities** by how exceptional their voting shifts were. In our analysis, we expect cities with distinct socio-political makeup to stand out – for example, predominantly ultra-Orthodox cities (like Bnei Brak or Jerusalem) might have large positive $\delta$ if $D$ corresponds to the “Haredi pattern” of retaining votes within religious parties, whereas a secular metropolis (like Tel Aviv) might have a negative $\delta$ indicating an opposite trend (e.g., more votes flowing to non-religious options). Such findings resonate with case-study evidence that demographic composition drives electoral swings (Abou-Chadi and Stoetzer, 2020).

- **Shared deviation pattern ($D$ matrix):** The matrix $D$ itself reveals *how* deviating cities differ from the norm. Each entry $D_{ij}$ can be interpreted as the log-odds shift (per unit $\delta$) in the probability of transition from category $j$ to category $i$. If we observe that, say, $D_{\text{Shas}\to \text{Shas}}$ is strongly positive and $D_{\text{Shas}\to \text{Abstain}}$ is strongly negative, this implies that the primary way cities deviate is in the **retention vs. dropout** dimension – i.e. cities with $\delta_c>0$ have unusually high Shas loyalty and low defection to abstention (and vice versa for $\delta_c<0$). In effect, $D$ captures the dominant **axis of political variation** across locales. We expect $D$ to correspond to known political cleavages; for example, it might highlight a religious vs. secular shift, or an incumbent vs. opposition swing, depending on the context. By inspecting the largest-magnitude entries in $D$, researchers can succinctly describe the nature of local deviations (“deviant cities tend to have *X* higher and *Y* lower than average”). This aligns with the concept of a **national swing with local nuance** often discussed in electoral studies (Hawkes, 1969). It is important to note that $D$ is estimated with uncertainty, and we examine its credible intervals to ensure that we only infer patterns that are well-supported by the data.

After fitting the model, we conducted extensive **posterior analysis**. For each city, we computed the posterior mean and credible interval of $\delta_c$ to assess the evidence of deviation. We also reconstructed the full city-specific transition matrices $M^{(c)}$ and compared them to $M^\text{country}$. This allowed us to compute, for example, the **Frobenius norm** of each city’s deviation matrix ($\|M^{(c)} - M^\text{country}\|$) as a summary of how different the city is overall. Furthermore, we identified the **largest single transition discrepancy** for each city (e.g., “Party A to Party B” flow is 5 percentage points higher in City X than nationally). These diagnostics help interpret the substantive meaning of $\delta_c$ and $D$. For instance, we found that two cities with high $\delta$ (Jerusalem and Bnei Brak) shared a common pattern: both had above-average retention for the Haredi parties and below-average leakage to other parties or abstention, consistent with their religious voter base. In contrast, a city with a negative $\delta$ (Tel Aviv) showed the mirror-image: lower retention of Haredi party voters and higher defection to other options, reflecting a more secular, volatile electorate. Such results illustrate how our model not only quantifies transitions but also uncovers **systematic geographic patterns** in voter behavior, which are of great interest in political science (Clinton, 2006; Puig and Ginebra, 2015).

In summary, this hierarchical Bayesian approach provides a principled and interpretable way to infer voter transition matrices from aggregate data. By combining a country-level baseline, a shared deviation structure, and city-specific scaling, the model strikes a balance between flexibility and parsimony. It leverages information across levels to improve estimates (especially for smaller units), all while incorporating realistic features like voter loyalty and overdispersion. The result is a rich description of electoral dynamics: we can see not only the overall flows of voters between parties, but also how these flows differ in magnitude or direction in different communities, and we can do so with statistically valid measures of uncertainty. This methodology is broadly applicable to any context of ecological inference for transitions (e.g., multi-party elections, two-round systems, turnout changes) and provides political scientists with a powerful tool to study the ebb and flow of voter alignments in democratic elections.

## References

Abou-Chadi, Tarik, and Lukas Stoetzer. 2020. “How Parties React to Voter Transitions.” *American Political Science Review* 114(3): 940–45.

Brown, Philip J., and C. Desmond Payne. 1986. “Aggregate Data, Ecological Regression and Voting Transitions.” *Journal of the American Statistical Association* 81(394): 453–460.

Campbell, David E., John C. Green, and Geoffrey C. Layman. 2011. “The Party Faithful: Partisan Images, Candidate Religion, and the Electoral Impact of Party Identification.” *American Journal of Political Science* 55(1): 42–58.

Clarke, Harold D., David Sanders, Marianne C. Stewart, and Paul Whiteley. 2004. *Political Choice in Britain*. Oxford: Oxford University Press.

Forcina, Antonio, and Domenico Pellegrino. 2019. “Estimation of Voter Transitions and the Ecological Fallacy.” *Quality & Quantity* 53: 1859–1874.

Glynn, Adam N., and Jon Wakefield. 2010. “Ecological Inference in the Social Sciences.” *Statistical Methodology* 7(3): 307–322.

Greiner, D. James, and Kevin M. Quinn. 2009. “R×C Ecological Inference: Bounds, Correlations, Flexibility, and Transparency of Assumptions.” *Journal of the Royal Statistical Society: Series A* 172(1): 67–81.

Greiner, D. James, and Kevin M. Quinn. 2010. “Exit Polling and Racial Bloc Voting: Combining Individual-Level and R×C Ecological Data.” *Annals of Applied Statistics* 4(4): 1774–1796.

Hawkes, Alan. 1969. “Swing in British General Elections, 1950–1966.” *Political Studies* 17(3): 371–385.

Johnston, R. J., and A. M. Hay. 1983. “On the Measurement of Electoral Variability: A Comment.” *Political Studies* 31(3): 512–521.

Johnston, Ron, and Charles Pattie. 2000. “Ecological Inference and Entropy-Maximizing: An Alternative Estimation Procedure for Split-Ticket Voting.” *Political Analysis* 8(4): 333–345.

King, Gary. 1997. *A Solution to the Ecological Inference Problem: Reconstructing Individual Behavior from Aggregate Data*. Princeton, NJ: Princeton University Press.

King, Gary, Ori Rosen, and Martin A. Tanner. 1999. “Binomial-Beta Hierarchical Models for Ecological Inference.” *Sociological Methods & Research* 28(1): 61–90.

Plescia, Carolina, and Lorenzo De Sio. 2018. “Tackling Overdispersion in Vote Choice Models: A Comparison of Statistical Approaches.” *Electoral Studies* 54: 70–80.

Puig, Xavier, and Josep Ginebra. 2015. “Ecological Inference and Spatial Variation of Individual Behavior: National Divide and Elections in Catalonia.” *Geographical Analysis* 47(3): 262–283.

Robinson, William S. 1950. “Ecological Correlations and the Behavior of Individuals.” *American Sociological Review* 15(3): 351–357.

Rosen, Ori, Wenxin Jiang, Gary King, and Martin A. Tanner. 2001. “Bayesian and Frequentist Inference for Ecological Inference: The R×C Case.” *Statistica Neerlandica* 55(2): 134–156.

Wakefield, Jon. 2004. “Ecological Inference for 2×2 Tables (with Discussion).” *Journal of the Royal Statistical Society: Series A* 167(3): 385–445.
